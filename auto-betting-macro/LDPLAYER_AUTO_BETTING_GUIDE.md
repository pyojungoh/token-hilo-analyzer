# LDPlayer 설치 + 에뮬레이터 기반 자동배팅기 제작 가이드

이 문서는 (1) LDPlayer 다운로드·설치 방법과 (2) LDPlayer와 조합해서 가상 자동배팅기를 만드는 **전체 순서(Phase)** 를 정리한 것이다. AI/개발자가 이 가이드를 보고 단계별로 구현할 수 있도록 작성했다.

---

## Part 1. LDPlayer 다운로드 및 설치

### 1.1 다운로드

- **공식 사이트**: https://kr.ldplayer.net/
- **다운로드**: 메인 페이지에서 **「LD플레이어 다운로드」** 또는 **「바로 다운로드」** 버튼 클릭  
  - 직접 링크 예: `https://res.ldrescdn.com/download/LDPlayer9.exe?n=LDPlayer9_kr_xxxx_ld.exe` (공식 페이지에서 받는 것이 안전함)
- **권장 버전**: **LDPlayer 9** (안드로이드 9 기반, 최신·성능 좋음)

### 1.2 설치 절차

1. 다운로드한 **LDPlayer9.exe** 실행.
2. 설치 경로 선택 (기본값 사용 가능).
3. 설치 진행 후 완료되면 **종료**.
4. 필요 시 **재부팅** (VT 관련 설정을 바꿨다면 재부팅이 필요할 수 있음).

### 1.3 설치 후 권장 설정

- **VT(가상화) 활성화**  
  - BIOS에서 VT-x(Intel) 또는 SVM(AMD) 켜기.  
  - LDPlayer 공식: [VT 활성화 방법](https://kr.ldplayer.net/blog/4.html)  
  - 미활성화 시 렉·튕김 가능.
- **에뮬레이터 실행**  
  - LDPlayer 9를 한 번 실행해 안드로이드가 정상 부팅되는지 확인.
- **ADB 포트 확인**  
  - 기본적으로 LDPlayer는 **ADB**로 연결 가능.  
  - 보통 `127.0.0.1:5555` 등 (멀티 인스턴스 시 인스턴스마다 다른 포트).  
  - 나중에 자동배팅 스크립트에서 이 포트로 연결한다.

### 1.4 ADB 연결 확인 (선택)

- PC에 **ADB** 설치 후:
  - LDPlayer 실행 상태에서
  - `adb connect 127.0.0.1:5555` (LDPlayer 기본 포트는 제품/버전마다 다를 수 있음. LDPlayer 설정 또는 공식 문서 참고)
- 연결되면 `adb devices` 에 에뮬레이터가 보여야 한다.

---

## Part 1.5 ADB 설치 (처음부터)

ADB(Android Debug Bridge)는 PC에서 에뮬레이터(또는 실제 안드로이드 기기)에 명령을 보낼 때 쓰는 도구다. **Android Studio를 쓰지 않는다면** 아래처럼 Platform-Tools만 설치하면 된다.

### 1.5.1 다운로드

1. **공식 페이지** 접속: https://developer.android.com/studio/releases/platform-tools  
2. **Windows용** 다운로드:
   - 페이지에서 "Download SDK Platform-Tools for **Windows**" 링크 클릭.
   - 이용 약관에 동의 후 `platform-tools-latest-windows.zip` 받기.
   - 직접 링크(동의 후 사용): `https://dl.google.com/android/repository/platform-tools-latest-windows.zip`

### 1.5.2 압축 해제 및 폴더 위치

1. 다운로드한 **ZIP 파일**을 압축 해제.
2. 안에 **`platform-tools`** 폴더가 생긴다. 이 폴더 안에 `adb.exe` 가 있어야 한다.
3. 이 폴더를 **이동하기 쉬운 위치**에 둔다.  
   - 예: `C:\adb\platform-tools`  
   - (원하면 `C:\Users\본인계정\platform-tools` 등 다른 경로도 가능. 경로에 **한글/공백 없이** 두는 편이 안전하다.)

### 1.5.3 환경 변수 설정 (어디서나 `adb` 명령 쓰기)

1. **Windows 검색**에서 **「환경 변수」** 또는 **「시스템 환경 변수 편집」** 검색 후 실행.
2. **시스템 속성** 창에서 **고급** 탭 → **환경 변수** 클릭.
3. **시스템 변수** (아래쪽 목록)에서 **새로 만들기** 클릭.
   - **변수 이름**: `Path` 가 이미 있으면 4번으로. 없으면 새 변수 이름에 `Path` 입력하고 값에 `C:\adb\platform-tools` 넣고 확인.
4. **시스템 변수** 목록에서 **Path** 선택 → **편집** 클릭.
   - **새로 만들기** 클릭 후 **platform-tools 폴더 경로** 입력.  
     예: `C:\adb\platform-tools`
   - **확인**으로 모두 닫기.
5. **중요**: 이미 연 **명령 프롬프트**나 **PowerShell**은 환경 변수가 반영되지 않으므로 **새로 연 터미널**에서 확인한다.

### 1.5.4 설치 확인

1. **명령 프롬프트(cmd)** 또는 **PowerShell**을 **새로** 연다.
2. 다음 입력 후 Enter:
   ```text
   adb version
   ```
3. ADB 버전 정보가 나오면 **설치 성공**이다.
4. (선택) LDPlayer를 **실행한 상태**에서:
   ```text
   adb connect 127.0.0.1:5554
   adb devices
   ```
   - LDPlayer 공식 문서 기준 **첫 번째 인스턴스 포트는 5554**이다. (5555 아님.)  
   - 멀티 인스턴스: 0번=5554, 1번=5556, 2번=5558, 3번=5560 (5554 + 인덱스×2).  
   - `devices` 목록에 해당 주소가 보이면 에뮬레이터 연결 정상이다.  
   - 연결이 안 되면 LDPlayer **설치 폴더 안의 adb.exe**로 `adb devices`를 실행해 보거나, 설정에서 ADB(로컬 디버깅)가 켜져 있는지 확인한다.

### 1.5.5 참고

- **Android Studio**를 이미 설치했다면, Studio에 포함된 SDK의 `platform-tools`를 쓰면 된다.  
  - 보통 `C:\Users\본인계정\AppData\Local\Android\Sdk\platform-tools`  
  - 이 경로를 **Path**에 넣어 두면 별도 ZIP 설치 없이 `adb` 사용 가능.

---

## Part 2. 에뮬레이터 기반 자동배팅기 – 제작 순서(Phase)

아래 순서대로 진행하면, **PC 프로그램(기존 Analyzer + 매크로 로직)** 과 **LDPlayer 에뮬레이터(배팅 사이트/앱이 뜨는 곳)** 를 조합한 “가상 자동배팅기”를 만들 수 있다.

---

### Phase 0: 전제 조건 정리

- **기존 자동배팅 매크로**: `auto-betting-macro/macro.py`  
  - Analyzer 서버 `/api/current-pick` 폴링 → RED/BLACK 픽에 따라 **PC 내장 브라우저**에서 버튼 클릭.  
  - 배팅 사이트가 매크로 방지를 쓰면 **PC 브라우저 자동화는 차단**될 수 있음.
- **목표**: 배팅은 **LDPlayer 에뮬레이터 안**(모바일 브라우저 또는 앱)에서 하고, **PC에서는 예측 픽만 가져와서 에뮬레이터에 “입력”만 넣어 주는 구조**.

---

### Phase 1: LDPlayer 환경 고정

1. **LDPlayer 설치 완료** (Part 1 참고).
2. **배팅 사이트/앱 준비**  
   - 에뮬레이터 안에서 배팅 사이트 **URL**을 브라우저로 열거나, 배팅 **앱** 설치.
3. **화면·해상도 고정**  
   - 한 번 정한 해상도/창 크기는 나중에 **좌표 기반 자동화** 시 유지하는 것이 좋음.
4. **ADB 포트 확인**  
   - 사용할 인스턴스의 ADB 포트 번호를 적어 둠 (예: 5555). 멀티 인스턴스면 인스턴스별 포트 정리.

**산출물**: “LDPlayer 실행 → 배팅 화면까지 수동으로 열 수 있는 상태” + “ADB 포트 번호”.

---

### Phase 2: 에뮬레이터 내부 좌표(또는 요소) 파악

1. **배팅 화면에서 자동화할 대상 정리**  
   - 예: 금액 입력 칸, RED 버튼, BLACK 버튼, 확인 버튼 등.
2. **좌표 수집**  
   - **에뮬레이터 매크로 한곳에서**: `emulator_macro.py` 실행 후 **좌표 설정** 그룹에서  
     「배팅금액 좌표 찾기」「정정 좌표 찾기」「레드 좌표 찾기」「블랙 좌표 찾기」 버튼을 누르고  
     창이 최소화된 뒤 LDPlayer 화면에서 해당 위치를 클릭하면 좌표가 `emulator_coords.json` 에 저장된다.  
   - (별도: `coord_picker.py` 로만 좌표만 잡을 수도 있다.)  
   - 또는 LDPlayer/에뮬레이터 기준 **픽셀 좌표 (x, y)** 를 스크린샷 등으로 직접 잡을 수 있다.
   - **탭/입력이 안 될 때**:  
     1) **ADB 연결 확인** 버튼으로 `adb devices` 결과를 보고, 기기가 나오는지 확인. 없으면 터미널에서 `adb connect 127.0.0.1:5555` 실행.  
     2) **ADB 테스트 탭** 버튼을 누르면 배팅금액 위치에 1회 탭하고, 로그에 나온 `adb -s ... shell input tap X Y` 명령을 **cmd에서 그대로 실행**해 보기. 에뮬레이터에서 반응이 있으면 매크로는 정상이고 좌표만 조정하면 됨.  
     3) **LDPlayer 창 왼쪽 위** X, Y에 **창이 화면에서 차지하는 왼쪽 위 모서리** 좌표를 넣고 **창 위치 저장**. (창이 (0,0)에 붙어 있으면 비움.)  
     4) 창 크기와 기기 해상도가 다르면 **해상도 보정**에 창 가로/세로, 기기 가로/세로 입력 후 창 위치 저장.
3. **문서화**  
   - `coord_picker` 를 썼다면 `emulator_coords.json` 이 곧 좌표 목록이다.  
   - 그렇지 않다면 `금액 입력란: (x1, y1)`, `RED: (x2, y2)`, `BLACK: (x3, y3)` 등으로 정리.

**산출물**: “배팅 화면에서 클릭/입력할 영역의 좌표 목록(또는 `emulator_coords.json`)”.

---

### Phase 3: PC → 에뮬레이터 입력 방식 결정 및 검증

1. **입력 방식 선택**  
   - **방식 A**: **ADB**로 에뮬레이터에 텍스트/탭 전송  
     - `adb shell input text "123"`, `adb shell input tap X Y`  
     - PC에서 Python 등으로 `subprocess` 또는 ADB 라이브러리 호출.
   - **방식 B**: **에뮬레이터 창에 대한 마우스/키보드 자동화**  
     - PyAutoGUI 등으로 LDPlayer 창이 포커스일 때 클릭/키 입력.  
     - 좌표는 “에뮬레이터 창 내부” 기준으로 보정 필요.
2. **동작 검증**  
   - LDPlayer에서 배팅 화면 연 상태에서,  
     - (A) ADB로 금액 숫자 입력 + RED/BLACK 탭 한 번씩 보내서 실제로 입력·클릭되는지,  
     - (B) 또는 PyAutoGUI로 창에 클릭/입력이 들어가는지  
     **한 번씩 수동 스크립트로 테스트**.

**산출물**: “실제로 에뮬레이터 배팅 화면에 입력/클릭이 들어가는, 검증된 방식(ADB 또는 창 자동화)”.

---

### Phase 4: Analyzer 연동 설계

1. **픽 소스**  
   - 기존처럼 **Analyzer 서버** `GET /api/current-pick` 으로 현재 픽(RED/BLACK 등) 가져오기.
2. **동작 시나리오**  
   - 주기적으로(예: 2초마다) `/api/current-pick` 호출  
     → 픽이 바뀌었을 때만  
     → 에뮬레이터에 “금액 입력 → RED 또는 BLACK 클릭” 순서로 전송.
3. **설정 항목**  
   - Analyzer URL, 폴링 간격, 배팅 금액, RED/BLACK 좌표(또는 ADB용 좌표), ADB 포트 등.  
   - 기존 매크로의 설정(URL, RED/BLACK, 폴링)을 **에뮬레이터용**으로 확장하는 형태로 설계.

**산출물**: “에뮬레이터 자동배팅기의 입력/출력 스펙(픽 API → 에뮬 입력 매핑)”.

---

### Phase 5: 에뮬레이터 전용 자동배팅 스크립트 구현

1. **프로젝트 위치**  
   - `auto-betting-macro/` 아래에 에뮬레이터용 스크립트 추가 (예: `emulator_macro.py` 또는 기존 `macro.py`에 “에뮬레이터 모드” 분기).
2. **구현할 기능**  
   - Analyzer URL 설정, 폴링 간격 설정.  
   - `/api/current-pick` 폴링.  
   - 픽 변경 시:  
     - (선택) 금액 입력 → RED 또는 BLACK 클릭 (Phase 3에서 정한 방식으로).  
   - 로그: 마지막 픽, 마지막 동작 시각, 에러 메시지 등.
3. **설정 파일 또는 UI**  
   - ADB 포트, RED/BLACK 좌표, 금액, (필요 시) 배팅 사이트 URL 등 Phase 2·4에서 정한 값을 설정으로 넣을 수 있게 함.

**산출물**: “LDPlayer에서 동작시킬 수 있는 자동배팅 스크립트(실행 가능한 코드)”.

---

### Phase 6: 테스트 및 조정

1. **순서 테스트**  
   - LDPlayer 실행 → 배팅 화면 열기 → 자동배팅 스크립트 실행  
   - Analyzer에서 픽이 바뀌었을 때 에뮬레이터에만 입력이 들어가는지 확인.
2. **좌표/설정 조정**  
   - 해상도나 UI가 바뀌면 Phase 2 좌표를 다시 잡고 설정만 수정.
3. **매크로 방지 대응**  
   - 사이트가 매크로를 막으면, 입력 간격·패턴을 사람처럼 보이게 조정하는 것은 “정책/리스크” 영역이므로 가이드에서는 “필요 시 타이밍·재시도 로직 조정” 정도만 명시.

**산출물**: “에뮬레이터 + PC 스크립트 조합으로 한 사이클(픽 수신 → 에뮬 입력)이 안정적으로 동작하는 상태”.

---

## 요약: 진행 순서 체크리스트

| 순서 | 내용 | 산출물 |
|------|------|--------|
| Part 1 | LDPlayer 다운로드·설치·ADB 확인 | 설치된 LDPlayer + ADB 포트 |
| Phase 1 | LDPlayer에서 배팅 화면까지 열기, 포트 고정 | 실행 절차 + 포트 번호 |
| Phase 2 | 배팅 화면 좌표(금액, RED, BLACK 등) 수집 | 좌표 목록/설정 포맷 |
| Phase 3 | PC→에뮬 입력 방식(ADB vs 창 자동화) 결정 및 검증 | 검증된 입력 방식 |
| Phase 4 | Analyzer 픽 API와 연동 설계 | 연동 스펙 |
| Phase 5 | 에뮬레이터용 자동배팅 스크립트 구현 | 실행 가능한 코드 |
| Phase 6 | 테스트·좌표·설정 조정 | 안정 동작 상태 |

이 가이드를 **위에서 아래 순서대로** 진행하면, LDPlayer와 조합한 가상 자동배팅기를 단계별로 완성할 수 있다.
